<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Create a basemap • tools4watlas</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../deps/search-1.0.0/fuse.min.js"></script><script src="../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Create a basemap">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">tools4watlas</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Basic workflow (Vignettes)</h6></li>
    <li><a class="dropdown-item" href="../../articles/load_and_check_data.html">Load and check data</a></li>
    <li><a class="dropdown-item" href="../../articles/filter_data.html">Filter data</a></li>
    <li><a class="dropdown-item" href="../../articles/smooth_and_thin_data.html">Smooth and thin data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extended workflow</h6></li>
    <li><a class="dropdown-item" href="../../articles/extended_workflow/add_tidal_and_bathymetry_data.html">Add tidal and bathymetry data</a></li>
    <li><a class="dropdown-item" href="../../articles/extended_workflow/cluster_data_in_residency_patches.html">Clustering in residency patches</a></li>
    <li><a class="dropdown-item" href="../../articles/extended_workflow/add_SIBES_data.html">Add SIBES data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Visualization tutorials</h6></li>
    <li><a class="dropdown-item" href="../../articles/visualization_tutorials/create_basemap.html">Create a basemap</a></li>
    <li><a class="dropdown-item" href="../../articles/visualization_tutorials/plot_data.html">Plot data</a></li>
    <li><a class="dropdown-item" href="../../articles/visualization_tutorials/plot_data_in_loop.html">Plot data in loop</a></li>
    <li><a class="dropdown-item" href="../../articles/visualization_tutorials/plot_data_faster.html">Plot data faster</a></li>
    <li><a class="dropdown-item" href="../../articles/visualization_tutorials/plot_data_interactively.html">Plot data interactively</a></li>
    <li><a class="dropdown-item" href="../../articles/visualization_tutorials/plot_data_base_R.html">Plot data in base R - deprecated</a></li>
    <li><a class="dropdown-item" href="../../articles/visualization_tutorials/animate_data.html">Animate data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Package development</h6></li>
    <li><a class="dropdown-item" href="../../articles/package_development/package_maintenance.html">Package maintenance</a></li>
    <li><a class="dropdown-item" href="../../articles/package_development/basemap_data.html">Basemap data</a></li>
    <li><a class="dropdown-item" href="../../articles/package_development/package_logo.html">tools4watlas logo</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../articles/literature/literature.html">Literature</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/allertbijleveld/tools4watlas/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Create a basemap</h1>
                        <h4 data-toc-skip class="author">Johannes
Krietsch</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/allertbijleveld/tools4watlas/blob/HEAD/vignettes/visualization_tutorials/create_basemap.Rmd" class="external-link"><code>vignettes/visualization_tutorials/create_basemap.Rmd</code></a></small>
      <div class="d-none name"><code>create_basemap.Rmd</code></div>
    </div>

    
    
<p>This article shows how to make different basemaps to plot the
movement data on. Here we present three options: A simple basemap using
polygons provided with the package (see also article: <a href="https://allertbijleveld.github.io/tools4watlas/articles/package_development/basemap_data.html">Basemap
data</a>), a simple basemap based on bathymetry data and flexible
approach using the package <code>OpenStreetMap</code> (e.g. to plot on a
satellite image).</p>
<div class="section level4">
<h4 id="load-packages">Load packages<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://allertbijleveld.github.io/tools4watlas/">tools4watlas</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-ggplot2-and-a-basemap-layer">Using <code>ggplot2</code> and a basemap layer<a class="anchor" aria-label="anchor" href="#using-ggplot2-and-a-basemap-layer"></a>
</h2>
<p>One can create a simple basemaps of the study area by using the
function <code><a href="../../reference/atl_create_bm.html">atl_create_bm()</a></code>. This function uses a data.table
with x- and y-coordinates to check the required bounding box (which can
be extended with a buffer in meters) and spatial features (polygons) of
land, lakes, mudflats and rivers. Without adding spatial data, it will
default to the spatial data provided in the package. By changing
<code>asp</code> the desired aspect ratio can be chosen (default is
“16:9”). The resulting map is always in EPSG:32631 (WGS 84 / UTM zone
31N), but the data can be provided in other projections, which then
needs to be specified as <code>projection</code>.</p>
<div class="section level3">
<h3 id="basemap-independent-of-movement-data">Basemap independent of movement data<a class="anchor" aria-label="anchor" href="#basemap-independent-of-movement-data"></a>
</h3>
<p>This can be useful when one wants to zoom into a specific area of the
plot or has an area of interest, but the movement data also go out of
this range. If no data are provided the function creates a map around
Griend (our main study site) with a specified buffer.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create basemap</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/atl_create_bm.html">atl_create_bm</a></span><span class="op">(</span>buffer <span class="op">=</span> <span class="fl">30000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="va">bm</span></span></code></pre></div>
<p><img src="create_basemap_files/figure-html/unnamed-chunk-2-1.png" alt="Basemap around Griend" width="100%"></p>
<p>Alternatively, one can provide a table with one or multiple
locations, which will then be used to buffer the map. This can for
example be a location in EPSG:4326 (WGS 84 in degrees) that can be
exacted from <a href="https://www.google.com/maps/@53.1892078,5.5670405,68619m/data=!3m1!1e3?entry=ttu&amp;g_ep=EgoyMDI1MDIwNS4xIKXMDSoASAFQAw%3D%3D" class="external-link">Google
Maps</a> by a right click on a specific location. Here I choose a point
a bit east of Griend, to include Richel and Ballastplaat in the map.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define location</span></span>
<span><span class="va">location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.275</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">53.2523</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create basemap</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/atl_create_bm.html">atl_create_bm</a></span><span class="op">(</span><span class="va">location</span>, buffer <span class="op">=</span> <span class="fl">7000</span>, projection <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fl">4326</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="va">bm</span></span></code></pre></div>
<p><img src="create_basemap_files/figure-html/unnamed-chunk-3-1.png" alt="Basemap around Griend" width="100%"></p>
</div>
<div class="section level3">
<h3 id="basemap-with-extend-of-movement-data">Basemap with extend of movement data<a class="anchor" aria-label="anchor" href="#basemap-with-extend-of-movement-data"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load example data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data_example</span></span>
<span></span>
<span><span class="co"># create basemap</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/atl_create_bm.html">atl_create_bm</a></span><span class="op">(</span><span class="va">data</span>, buffer <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="va">bm</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span></span></code></pre></div>
<p><img src="create_basemap_files/figure-html/unnamed-chunk-4-1.png" alt="Points and tracks on basemap" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="basemap-with-bathymetry-data">Basemap with bathymetry data<a class="anchor" aria-label="anchor" href="#basemap-with-bathymetry-data"></a>
</h2>
<p>Bathymetry data can be found in the “Birds, fish ’n chips” SharePoint
folder: <code>Documents/data/GIS/rasters/</code>. To run the script set
the file path (<code>fp</code>) to the local copy of the folder on your
computer. The data can also be downloaded from the <a href="https://datahuiswadden.openearth.nl/geonetwork/srv/eng/catalog.search#/metadata/JkrvJXasRSGAWU1mJLHUzg" class="external-link">Waddenregister</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># additional packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># file path to Birds, fish 'n chips GIS/rasters folder</span></span>
<span><span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/atl_file_path.html">atl_file_path</a></span><span class="op">(</span><span class="st">"rasters"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load bathymetry data</span></span>
<span><span class="va">bat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">fp</span>, <span class="st">"bathymetry/2024/bodemhoogte_20mtr_UTM31_int.tif"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create base map with bathymetry data</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/atl_create_bm.html">atl_create_bm</a></span><span class="op">(</span></span>
<span>  buffer <span class="op">=</span> <span class="fl">5000</span>, raster_data <span class="op">=</span> <span class="va">bat</span>, option <span class="op">=</span> <span class="st">"bathymetry"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="va">bm</span></span></code></pre></div>
<p><img src="create_basemap_files/figure-html/unnamed-chunk-5-1.png" alt="Bathymetry map" width="100%"></p>
<p>We can also add some shading (<code>shade = TRUE</code>) to the
bathymetry data to highlight the water depth better. Note that
calculating the shade can take a while, especially for large maps. So,
only use this option for polished maps.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># additional packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># file path to Birds, fish 'n chips GIS/rasters folder</span></span>
<span><span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/atl_file_path.html">atl_file_path</a></span><span class="op">(</span><span class="st">"rasters"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load bathymetry data</span></span>
<span><span class="va">bat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">fp</span>, <span class="st">"bathymetry/2024/bodemhoogte_20mtr_UTM31_int.tif"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create base map with bathymetry data</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/atl_create_bm.html">atl_create_bm</a></span><span class="op">(</span></span>
<span>  buffer <span class="op">=</span> <span class="fl">5000</span>, raster_data <span class="op">=</span> <span class="va">bat</span>, option <span class="op">=</span> <span class="st">"bathymetry"</span>, shade <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="va">bm</span></span></code></pre></div>
<p><img src="create_basemap_files/figure-html/unnamed-chunk-6-1.png" alt="Bathymetry map with shade" width="100%"></p>
</div>
<div class="section level2">
<h2 id="basemap-with-openstreetmap">Basemap with <code>OpenStreetMap</code><a class="anchor" aria-label="anchor" href="#basemap-with-openstreetmap"></a>
</h2>
<p>Provides a range of different basemap options. For this we first have
to transform the data to WGS 84 to extract the basemap with the bounding
box and then transform our data to a Mercator projection to plot the
data on top of the map.</p>
<p>Unfortunately, sometimes the <code>type = "bing"</code> (satellite
image) does not work.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># additional packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ifellows/ROSM" class="external-link">OpenStreetMap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load example data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data_example</span></span>
<span></span>
<span><span class="co"># make data spatial and transform projection to WGS 84 (used in osm)</span></span>
<span><span class="va">d_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/atl_as_sf.html">atl_as_sf</a></span><span class="op">(</span><span class="va">data</span>, additional_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tag"</span>, <span class="st">"datetime"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">d_sf</span>, crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fl">4326</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get bounding box</span></span>
<span><span class="va">bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/atl_bbox.html">atl_bbox</a></span><span class="op">(</span><span class="va">d_sf</span>, asp <span class="op">=</span> <span class="st">"16:9"</span>, buffer <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract openstreetmap</span></span>
<span><span class="co"># other 'type' options are "osm", "maptoolkit-topo", "bing", "stamen-toner",</span></span>
<span><span class="co"># "stamen-watercolor", "esri", "esri-topo", "nps", "apple-iphoto", "skobbler";</span></span>
<span><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/OpenStreetMap/man/openmap.html" class="external-link">openmap</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bbox</span><span class="op">[</span><span class="st">"ymax"</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">[</span><span class="st">"xmin"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bbox</span><span class="op">[</span><span class="st">"ymin"</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">[</span><span class="st">"xmax"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"osm"</span>, mergeTiles <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/OpenStreetMap/man/autoplot.OpenStreetMap.html" class="external-link">autoplot.OpenStreetMap</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># transform points to Mercator and add transformed coordinates to data</span></span>
<span><span class="va">d_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">d_sf</span>, crs <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fl">3857</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">osm_coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">d_sf</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span>x_osm <span class="op">=</span> <span class="va">osm_coords</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, y_osm <span class="op">=</span> <span class="va">osm_coords</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="va">bm</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x_osm</span>, <span class="va">y_osm</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"darkorange"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fl">3857</span>, expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="create_basemap_files/figure-html/unnamed-chunk-7-1.png" alt="Static map with satellite image" width="100%"></p>
</div>
<div class="section level2">
<h2 id="additional-features">Additional features<a class="anchor" aria-label="anchor" href="#additional-features"></a>
</h2>
<p>How to add a WATLAS logo or receivers to a base map.</p>
<div class="section level3">
<h3 id="add-watlas-logo-to-a-basemap">Add WATLAS logo to a basemap<a class="anchor" aria-label="anchor" href="#add-watlas-logo-to-a-basemap"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># additional packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/GuangchuangYu/ggimage" class="external-link">ggimage</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load example data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data_example</span></span>
<span></span>
<span><span class="co"># create basemap</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/atl_create_bm.html">atl_create_bm</a></span><span class="op">(</span><span class="va">data</span>, buffer <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># path to WATLAS logo</span></span>
<span><span class="va">logo_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"extdata"</span>, <span class="st">"watlas_logo.png"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"tools4watlas"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define position based on data (here upper left corner)</span></span>
<span><span class="co"># adjust as desired</span></span>
<span><span class="va">x_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2500</span></span>
<span><span class="va">y_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create table with image of the logo</span></span>
<span><span class="va">di</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_pos</span>, y <span class="op">=</span> <span class="va">y_pos</span>, image <span class="op">=</span> <span class="va">logo_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot basemap with logo</span></span>
<span><span class="va">bm</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggimage/man/geom_image.html" class="external-link">geom_image</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">di</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, image <span class="op">=</span> <span class="va">image</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="create_basemap_files/figure-html/unnamed-chunk-8-1.png" alt="basemap with logo" width="100%"></p>
</div>
<div class="section level3">
<h3 id="add-watlas-receivers-to-a-basemap">Add WATLAS receivers to a basemap<a class="anchor" aria-label="anchor" href="#add-watlas-receivers-to-a-basemap"></a>
</h3>
<p>Receiver data are managed by Allert. They are located in the “WATLAS”
SharePoint folder: <code>Documents/data/</code>. Either specify the path
to your local copy of this folder or add the path for your user in the
<code><a href="../../reference/atl_file_path.html">atl_file_path()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load example data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data_example</span></span>
<span></span>
<span><span class="co"># create basemap</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/atl_create_bm.html">atl_create_bm</a></span><span class="op">(</span><span class="va">data</span>, buffer <span class="op">=</span> <span class="fl">20000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># file path to WATLAS teams data folder</span></span>
<span><span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/atl_file_path.html">atl_file_path</a></span><span class="op">(</span><span class="st">"watlas_teams"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load receivers data</span></span>
<span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">fp</span>, <span class="st">"receivers/receiver specifications.xlsx"</span><span class="op">)</span>,</span>
<span>  sheet <span class="op">=</span> <span class="st">"receivers"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># end date for active receivers as system date</span></span>
<span><span class="va">dr</span><span class="op">[</span><span class="va">active</span> <span class="op">==</span> <span class="st">"ja"</span>, <span class="va">date_removed</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># subset all active in period of tracking data</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">datetime</span><span class="op">)</span></span>
<span><span class="va">end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">datetime</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check if each row includes period of tracking data</span></span>
<span><span class="va">dr</span><span class="op">[</span>, <span class="va">includes_data</span> <span class="op">:=</span> <span class="op">(</span><span class="va">date_placed</span> <span class="op">&lt;=</span> <span class="va">end</span> <span class="op">&amp;</span> <span class="va">date_removed</span> <span class="op">&gt;=</span> <span class="va">start</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="va">dr</span><span class="op">[</span><span class="va">includes_data</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># plot basemap with receivers active during tracking period</span></span>
<span><span class="va">bm</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dr</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">17</span><span class="op">)</span></span></code></pre></div>
<p><img src="create_basemap_files/figure-html/unnamed-chunk-9-1.png" alt="basemap with receivers" width="100%"></p>
<p>One can also add the name of the receiver.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># additional packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/" class="external-link">ggrepel</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot basemap with receivers and label</span></span>
<span><span class="va">bm</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dr</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">17</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">dr</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, label <span class="op">=</span> <span class="va">location</span><span class="op">)</span>,</span>
<span>    max.overlaps <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    point.padding <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    segment.color <span class="op">=</span> <span class="st">"grey50"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="create_basemap_files/figure-html/unnamed-chunk-10-1.png" alt="basemap with receivers and label" width="100%"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.nioz.nl/en/about/organisation/staff/allert-bijleveld" class="external-link">Allert Bijleveld</a>, <a href="https://github.com/pratikunterwegs" class="external-link">Pratik Gupte</a>, <a href="https://github.com/CBeardsworth" class="external-link">Christine Beardsworth</a>, <a href="https://github.com/krietsch" class="external-link">Johannes Krietsch</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
