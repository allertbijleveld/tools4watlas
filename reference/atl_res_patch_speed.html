<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Construct residence patches from position data — atl_res_patch_speed • tools4watlas</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Construct residence patches from position data — atl_res_patch_speed"><meta name="description" content="A cleaned movement track of one individual at a time can be classified into
residence patches using the
function atl_res_patch_speed.
The function expects a specific organisation of the data: there should be
at least the following columns, X, Y, and time,
corresponding to the coordinates, and the time as POSIXct.
atl_res_patch_speed requires only three parameters: (1) the maximum
speed threshold between localizations (called max_speed), (2) the
distance threshold between clusters of positions (called
lim_spat_indep), and (3) the time interval between clusters
(called lim_time_indep).Clusters formed of fewer than a minimum
number of positions can be excluded.The exclusion of clusters with few
positions can help in removing bias due to short stops, but if such short
stops are also of interest, they can be included by reducing the
min_fixes argument. Position covariates such as speed may also be
summarised patch-wise by passing covariate names and  summary functions as
character vectors to the summary_variables and
summary_functions arguments, respectively."><meta property="og:description" content="A cleaned movement track of one individual at a time can be classified into
residence patches using the
function atl_res_patch_speed.
The function expects a specific organisation of the data: there should be
at least the following columns, X, Y, and time,
corresponding to the coordinates, and the time as POSIXct.
atl_res_patch_speed requires only three parameters: (1) the maximum
speed threshold between localizations (called max_speed), (2) the
distance threshold between clusters of positions (called
lim_spat_indep), and (3) the time interval between clusters
(called lim_time_indep).Clusters formed of fewer than a minimum
number of positions can be excluded.The exclusion of clusters with few
positions can help in removing bias due to short stops, but if such short
stops are also of interest, they can be included by reducing the
min_fixes argument. Position covariates such as speed may also be
summarised patch-wise by passing covariate names and  summary functions as
character vectors to the summary_variables and
summary_functions arguments, respectively."><meta property="og:image" content="https://allertbijleveld.github.io/tools4watlas/, https://krietsch.github.io/tools4watlas/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tools4watlas</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/basic_workflows.html">Basic workflow</a></li>
    <li><a class="dropdown-item" href="../articles/load_and_check_data.html">Loading and checking data</a></li>
    <li><a class="dropdown-item" href="../articles/plot_data.html">Plotting data</a></li>
    <li><a class="dropdown-item" href="../articles/process_data.html">Processing data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/allertbijleveld/tools4watlas/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Construct residence patches from position data</h1>
      <small class="dont-index">Source: <a href="https://github.com/allertbijleveld/tools4watlas/blob/master/R/fun_make_res_patch_speed.r" class="external-link"><code>R/fun_make_res_patch_speed.r</code></a></small>
      <div class="d-none name"><code>atl_res_patch_speed.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A cleaned movement track of one individual at a time can be classified into
residence patches using the
function <code>atl_res_patch_speed</code>.
The function expects a specific organisation of the data: there should be
at least the following columns, <code>X</code>, <code>Y</code>, and <code>time</code>,
corresponding to the coordinates, and the time as <code>POSIXct</code>.
<code>atl_res_patch_speed</code> requires only three parameters: (1) the maximum
speed threshold between localizations (called <code>max_speed</code>), (2) the
distance threshold between clusters of positions (called
<code>lim_spat_indep</code>), and (3) the time interval between clusters
(called <code>lim_time_indep</code>).Clusters formed of fewer than a minimum
number of positions can be excluded.The exclusion of clusters with few
positions can help in removing bias due to short stops, but if such short
stops are also of interest, they can be included by reducing the
<code>min_fixes</code> argument. Position covariates such as speed may also be
summarised patch-wise by passing covariate names and  summary functions as
character vectors to the <code>summary_variables</code> and
<code>summary_functions</code> arguments, respectively.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">atl_res_patch_speed</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  max_speed <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  lim_spat_indep <span class="op">=</span> <span class="fl">75</span>,</span>
<span>  lim_time_indep <span class="op">=</span> <span class="fl">180</span>,</span>
<span>  min_fixes <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  min_duration <span class="op">=</span> <span class="fl">120</span>,</span>
<span>  summary_variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  summary_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A dataframe of any class that is or extends data.frame of one
individual only. The dataframe must contain at least two spatial coordinates,
<code>X</code> and <code>Y</code>, and a temporal coordinate, <code>time</code>.</p></dd>


<dt id="arg-max-speed">max_speed<a class="anchor" aria-label="anchor" href="#arg-max-speed"></a></dt>
<dd><p>A numeric value specifying the maximum speed (m/s) between
two coordinates that would be considered non-transitory</p></dd>


<dt id="arg-lim-spat-indep">lim_spat_indep<a class="anchor" aria-label="anchor" href="#arg-lim-spat-indep"></a></dt>
<dd><p>A numeric value of distance in metres of the spatial
distance between two patches for them to the considered independent.</p></dd>


<dt id="arg-lim-time-indep">lim_time_indep<a class="anchor" aria-label="anchor" href="#arg-lim-time-indep"></a></dt>
<dd><p>A numeric value of time in minutes of the time
difference between two patches for them to be considered independent.</p></dd>


<dt id="arg-min-fixes">min_fixes<a class="anchor" aria-label="anchor" href="#arg-min-fixes"></a></dt>
<dd><p>The minimum number of fixes for a group of
spatially-proximate number of ponts to be considered a preliminary residence
patch.</p></dd>


<dt id="arg-min-duration">min_duration<a class="anchor" aria-label="anchor" href="#arg-min-duration"></a></dt>
<dd><p>The minimum duration (in seconds) for classifying
residence patches.</p></dd>


<dt id="arg-summary-variables">summary_variables<a class="anchor" aria-label="anchor" href="#arg-summary-variables"></a></dt>
<dd><p>Optional variables for which patch-wise summary
values are required. To be passed as a character vector.</p></dd>


<dt id="arg-summary-functions">summary_functions<a class="anchor" aria-label="anchor" href="#arg-summary-functions"></a></dt>
<dd><p>The functions with which to summarise the summary
variables; must return only a single value, such as median, mean etc. To be
passed as a character vector.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.frame extension object. This dataframe has the added column
<code>patch</code>, <code>patchdata</code>, and <code>polygons</code>, indicating the patch
identity, the localization data used to construct the patch, and the polygons
of residence patches based on the <code>lim_spat_indep</code>. In addition, there
are columns with patch summaries: nfixes, dist_in_patch, dist_bw_patch and
statistics based on the <code>summary_variables</code> and <code>summary_functions</code>
provided.
summary variables.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pratik R. Gupte, Christine E. Beardsworth &amp; Allert I. Bijleveld</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: ggplot2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load data</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="atl_get_data_csv.html">atl_get_data_csv</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reading file: /home/runner/work/_temp/Library/tools4watlas/extdata/redknot_2707_WATLAS_exampledata.csv</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/setattr.html" class="external-link">setnames</a></span><span class="op">(</span><span class="va">d</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate residency patches</span></span></span>
<span class="r-in"><span><span class="va">rp</span> <span class="op">&lt;-</span> <span class="fu">atl_res_patch_speed</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">d</span>,</span></span>
<span class="r-in"><span>  max_speed <span class="op">=</span> <span class="fl">3</span>, lim_spat_indep <span class="op">=</span> <span class="fl">75</span>, lim_time_indep <span class="op">=</span> <span class="fl">180</span>, min_fixes <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  min_duration <span class="op">=</span> <span class="fl">120</span>,</span></span>
<span class="r-in"><span>  summary_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"median"</span>, <span class="st">"sd"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"first"</span>, <span class="st">"last"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract data from all residency patches</span></span></span>
<span class="r-in"><span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="va">rp</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">patchdata</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">patch</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Merge with data</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">dr</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TAG</span>, <span class="va">posID</span>, <span class="va">patch</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TAG"</span>, <span class="st">"posID"</span><span class="op">)</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">patch</span><span class="op">)</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="atl_res_patch_speed-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Allert Bijleveld, Pratik Gupte, Christine Beardsworth, Johannes Krietsch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

